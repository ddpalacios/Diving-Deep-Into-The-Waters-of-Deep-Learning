
<html>
<title></title>

<script src="https://cdn.rawgit.com/BrainJS/brain.js/45ce6ffc/browser.js"></script>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-force.v2.min.js"></script>
<script src="https://d3js.org/d3-dispatch.v1.min.js"></script>
<script src="https://d3js.org/d3-quadtree.v1.min.js"></script>
<script src="https://d3js.org/d3-timer.v1.min.js"></script>
<script src="https://d3js.org/d3-force.v2.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.3.0/mustache.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.4/lodash.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//unpkg.com/brain.js"></script>
<script src="https://d3js.org/d3.v2.min.js?2.9.3"></script>
<style>

  #wrapper{
    margin-left: auto;
    margin-right: auto;
    width: 960px;
  }
  body{
    position: relative;
    right: 38vh;
  }
  /* form {
    margin: 50px 0 0 0;
  } */

  label {
    font: bold 20px Helvetica, sans-serif;
    display: block;
    float: left;
    text-align: right;
    padding: 5px 10px 0 0;
    width: 140px;
  }

  /* input[type=text] {
  float: left;
  width: 40px;
  font: bold 20px Helvetica, sans-serif;
  padding: 3px 0 0 0;
  text-align: center;
} */
  /* form div {
    overflow: hidden;
    margin: 0 0 5px 0;
  } */

  /* .button {
    margin: 0 0 0 5px;
    text-indent: -9999px;
    cursor: pointer;
    width: 29px;
    height: 29px;
    float: left;
    text-align: center;
    background: url(../images/buttons.png) no-repeat;
  } */

  .dec {
    background-position: 0 -29px;
  }

  /* .buttons {
    padding: 20px 0 0 140px;
  } */
</style>


<style>
  body {
    overflow: hidden;
  }

  .container {
    height: 100vh;
    width: 100vw;
    display: grid;
    grid-template-columns: 1fr;
    grid-template-rows: 30px 1fr 30px;
  }

  .body {
    display: grid;
    grid-template-columns: 1fr 3fr;
    overflow: hidden;
  }

  .content {
    overflow-y: scroll;
    padding: 20px;

  }

  .text {
    color: white;
    font-size: 16px;
    padding: 16px 32px;
  }

  .image {
    opacity: 1;
    display: block;
    width: 90%;
    height: auto;
    transition: .5s ease;
    backface-visibility: hidden;
  }

  .middle {
    transition: .5s ease;
    opacity: 0;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    text-align: center;
  }

  body {
    padding: 20px;
    font-family: sans-serif;
    background: #f2f2f2;
  }

  img {
    width: 80vh;
    /* need to overwrite inline dimensions */
    height: 70vh;
    overflow: hidden
  }

  h2 {
    margin-bottom: .5em;
  }

  .grid-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(30vh, 1fr));
    grid-gap: 1em;

  }



  /* hover styles */
  .location-listing {
    position: relative;
  }

  .location-image {
    line-height: 0;
    overflow: hidden;
  }

  .location-image img {
    filter: blur(0px);
    transition: filter 0.3s ease-in;
    transform: scale(1.1);
  }

  .location-title {
    font-size: 1.5em;
    font-weight: bold;
    text-decoration: none;
    z-index: 1;
    position: absolute;
    height: 100%;
    width: 100%;
    top: 0;
    left: 0;
    opacity: 0;
    transition: opacity .5s;
    background: rgba(90, 0, 10, 0.4);
    color: white;

    /* position the text in tâ€™ middle*/
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .location-listing:hover .location-title {
    opacity: 1;
  }

  .location-listing:hover .location-image img {
    filter: blur(2px);
  }


  /* for touch screen devices */
  @media (hover: none) {
    .location-title {
      opacity: 1;
    }

    .location-image img {
      filter: blur(2px);
    }
  }

  #footer {
    position: relative;
    bottom: 5px;
  }

  #footer ul {

    margin: 0px auto 0px auto;
    text-align: center;
  }

  #footer li {
    display: inline;
    margin: 0px 5px;
    color: rgb(75, 50, 50);
  }

  #footer a {
    color: rgb(44, 39, 75);
    bottom: -100px;
    text-decoration: none;
    font-weight: bolder;
  }

  #footer a:hover {
    color: rgb(255, 255, 255);
  }


  * {
    box-sizing: border-box;
  }



  label {
    text-align: right;
    display: block;
    padding: 0.5em 1.5em 0.5em 0;
  }

 

  @media (min-width: 400px) {
    form {
      overflow: hidden;
    }

    label {
      float: left;
      width: 200px;
    }

    input {
      float: left;
      width: calc(100% - 200px);
    }


  }



  text {
    pointer-events: none;
  }

  .node:hover {
    stroke: #999;
    stroke-opacity: .6;
    stroke-width: 4px;
  }


  .link {
    stroke: rgb(0, 0, 0);
    stroke-opacity: .6;
  }

  svg {
    position: relative;
    width: 95vh;
    outline: solid black;
    height: 42vh;
    right: 9vh;
    bottom: 50vh;
  }

  body {
    background-image: url('https://data.whicdn.com/images/262378523/original.gif');
  }



  .slidecontainer {
  position: relative;
  top: 6vh;
  width: 15vh;
  background-color: rgb(138, 59, 59);
}

.slider {
  -webkit-appearance: none;
  width: 100%;
  height: 25px;
  background: #d3d3d3;
  outline: none;
  opacity: 0.7;
  -webkit-transition: .2s;
  transition: opacity .2s;
}

.slider:hover {
  opacity: 1;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}

.slider::-moz-range-thumb {
  width: 25px;
  height: 25px;
  background: #4CAF50;
  cursor: pointer;
}
</style>

<style>
  .name {
    /* padding: 8px 90px;
    font-size: 16px;
    font-weight: 700; */
    background-color: #9acd32;
    border: 2px solid gray;
    color: #fff;
    box-shadow: 0 0 10px gray;
    margin-bottom: 10px;
    margin-top: 5px;
    cursor: pointer
  }

  input {
    padding: 8px;
    width: 65%;
    border: 3px solid #ddd;
    box-shadow: 0 0 2px;
    margin-bottom: 20px
  }

  .two {
    text-align: center;
    background-color: #fff;
    position: relative;
    width: 51vh;
    right: 2.7vh;
    bottom: 2vh;
    height: 35vh;
    padding: 40px 15px;
    border: 1px solid #000;
    border-radius: 4px;
    box-shadow: 0 0 5px #000;
    float: left;
    margin: 20px
  }
  .three{
    position: relative;
    background-color: #fff;
    top: 38vh;
    outline: solid black;
    height: 34vh;


  }
  
</style>


<head></head>
<div id="wrapper">
<body onload="Render()">

  <div style="background-color: rgb(153, 153, 153); outline: 5px solid black;width: 198vh; height: 10vh;"
    class="container">
    <h1 style="position: relative; left: 1vh; bottom: 2vh; ">Welcome to The Playground</h1>
    <a href="../index.html">
      <h3 style="position: relative; left:1vh;">Return to Homepage</h3>
    </a>
  </div>

<div class="sidebar" style="outline: 6px solid black;background-color: aliceblue;width: 50vh; position: relative; bottom: 1vh;">

  <div style=" outline: solid; background-color: rgb(84, 86, 131); height: 10vh;">
    <h1 style=" font-size: 4vh; position: relative; left: 7vh; top: 3vh;">Design Your Model:</h1>
  </div>

  <div class="two", id="two">
<div style="position: relative; bottom: 5vh;right: 1vh; height: 27vh;width: 48vh;">
<div style="height: 5vh; outline: solid black;">
  <h3 style="position:relative; right: 15vh;">Inputs #: </h3>
  <input min="1" id="in"onchange="OnChange()" style="position: relative;bottom: 5vh;left: 25vh; width: 10vh;" type="number" id="in_1" name="points"value=2 step="1">

</div>

<div style="outline: solid black; height: 5vh; position: relative;top: .5vh;">
<h3 style="position:relative; right: 20vh;">Output #:</h3>
<input min='1' id="out" onchange="OnChange()" style="position: relative;bottom: 5vh;left: 25vh; width: 10vh;" type="number" id="out_1" value=2 name="points" step="1">
</div>

<div style="outline: solid black; height: 5vh; position: relative;top: 1vh;">
  <h3 style="position:relative; right: 16vh;">Layer(s) #:</h3>
  <input min=1 max="5" id="layers" onchange="OnChange()" style="position: relative;bottom: 5vh;left: 25vh; width: 10vh;" type="number" id="layer_amount"value=1 name="points" step="1">
  </div>


    </div>
  </div>
<div class="three" id="three">
<div class="hid", id="hid">
  
  <div style="height: 5vh; position: relative; bottom: 15vh;">
    <button style="position: relative;bottom: 10vh;height: 100%; width: 100%;" class="name" onclick="SAVE()">SAVE</button>
    </div>
  
  <div style="width: 50vh; height: 5vh; position: relative;bottom: 13vh;  ">
    <div style="position: relative; bottom: 40vh;">
    <input id="hidden_units1"onchange="OnChange()" style=" width: 10vh;" type="number"min=1 max="10" id="in_1" name="points"Placeholder='layer 1' step="1">
    <input id="hidden_units2"onchange="OnChange()" style=" width: 10vh;" type="number"min=1 max="10" id="in_1" name="points"Placeholder='layer 2' step="1">
    <input id="hidden_units3"onchange="OnChange()" style="width: 10vh;" type="number"min=1 max="10" id="in_1" name="points"Placeholder='layer 3'step="1">
    <input id="hidden_units4"onchange="OnChange()" style="width: 10vh;" type="number"min=1 max="10" id="in_1" name="points"Placeholder='layer 4'step="1">
    <input id="hidden_units5"onchange="OnChange()" style="width: 10vh;" type="number"min=1 max="10" id="in_1" name="points"Placeholder='layer 5'step="1">
  </div>
    
  </div>
  

  <button style="position: relative;bottom: 45vh;height: 5vh; width: 100%;" class="name" onclick="Train()">TRAIN</button>


</div>

</div>

</div>
<div class="body_model" style=" background-color: rgba(161, 135, 135, 0.336); position: relative;width: 146vh; left: 52vh; bottom: 45vh; height:82vh; outline: 5px solid black;">
<div style="background-color:aliceblue; outline: 5px solid black; width: 45vh; position: relative; left: 98vh;top: 3vh; height: 40vh;" >
  <div style="background-color: rgb(84, 86, 131); outline: solid black;position: relative;left: .3vh;top:.5vh; height: 9vh; width: 45vh;" ></div>
  <h1 style="position: relative; left: 10vh;bottom: 10vh;">Configurations</h1>
 
</div>

<div style="position: relative;bottom:30vh; left: 102vh">
  
  <div style="position: relative;left:5vh">
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
      
    </div>
  
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
    </div>
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
    </div>
  </div>
  <div style="position: relative;left:25vh; bottom: 24.5vh;">
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
      
    </div>
  
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
    </div>
    <div class="slidecontainer">
      <input style="background-color: gray;" type="range" min="1" max="100" value="50">
    </div>
  </div>
  </div>
  <div id="training_box" style="position: relative;top: 5vh; text-align: center; background-color: rgb(84,86,131); outline: 5px solid black; height: 10vh;">
    <div id="scroller" style="outline: solid black; overflow: scroll;width: 95vh; height: 26vh;position: relative;top: 11vh;right: 10vh; "></div>
  </div>






</div>
<div style= " background-color:aliceblue; position: relative; top: 5.3vh; height: 29vh;width: 100%; outline:5px solid black;">
  <div style="text-align: center; background-color: rgb(84,86,131); outline: 5px solid black; height: 5vh;">
  
  </div>
</div>

</div>



</body>
</div>
<script>

 document.getElementById('hidden_units1').disabled = true
    document.getElementById('hidden_units2').disabled = true
    document.getElementById('hidden_units3').disabled = true
    document.getElementById('hidden_units4').disabled = true
    document.getElementById('hidden_units5').disabled = true


</script>



<script src=" https://requirejs.org/docs/release/2.3.5/minified/require.js"></script>

<script>

function OnChange(){
  var layer_num = extract_values("layers")
  if (layer_num == 5){
    document.getElementById('hidden_units1').disabled = false
    document.getElementById('hidden_units2').disabled = false
    document.getElementById('hidden_units3').disabled = false
    document.getElementById('hidden_units4').disabled = false
    document.getElementById('hidden_units5').disabled = false


  }
  if (layer_num == 4){
    document.getElementById('hidden_units1').disabled = false
    document.getElementById('hidden_units2').disabled = false
    document.getElementById('hidden_units3').disabled = false
    document.getElementById('hidden_units4').disabled = false
    document.getElementById('hidden_units5').disabled = true


  }
  if (layer_num == 3){
    document.getElementById('hidden_units1').disabled = false
    document.getElementById('hidden_units2').disabled = false
    document.getElementById('hidden_units3').disabled = false
    document.getElementById('hidden_units4').disabled = true
    document.getElementById('hidden_units5').disabled = true

  }
  if (layer_num == 2){
    document.getElementById('hidden_units1').disabled = false
    document.getElementById('hidden_units2').disabled = false
    document.getElementById('hidden_units3').disabled = true
    document.getElementById('hidden_units4').disabled = true
    document.getElementById('hidden_units5').disabled = true


  }
  if (layer_num == 1){
    document.getElementById('hidden_units1').disabled = false
    document.getElementById('hidden_units2').disabled = true
    document.getElementById('hidden_units3').disabled = true
    document.getElementById('hidden_units4').disabled = true
    document.getElementById('hidden_units5').disabled = true


  }

  Render()
  
}

  
</script>

<script>
  function extract_values(id) {

    var value = document.getElementById(id).value



    var res = parseInt(value)
    return res


  }
  function create_node(node_list, layer_num, label = "node") {

    node_list.push({ "label": label, "layer": layer_num })

  }

  function create_model(in_value,
    h1_value = null,
    h2_value = null,
    h3_value = null,
    h4_value = null,
    h5_value = null,
    out_value,
    hidden_amount) {
    var json = [{
      "nodes": [],

    }]
    var NODE_LIST = json[0].nodes


    // input layers
    for (var i = 0; i < in_value; i++) {
      create_node(NODE_LIST, layer = 0, label = "in")
    }


    //fill in hidden layers
    for (var i = 1; i <= hidden_amount; i++) {
      create_node(NODE_LIST, layer = parseInt(i), label = "hidden")


      if (h2_value == null) {

        if (parseInt(i) == 1) {
          for (var j = 1; j < h1_value; j++) {

            create_node(NODE_LIST, layer = 1, label = "hidden")
          }
        }
      }


      else if (h3_value == null) {

        if (parseInt(i) == 1) {
          for (var j = 1; j < h1_value; j++) {

            create_node(NODE_LIST, layer = 1, label = "hidden")
          }
        }


        if (parseInt(i) == 2) {
          for (var j = 1; j < h2_value; j++) {

            create_node(NODE_LIST, layer = 2, label = "hidden")
          }
        }



      }
      else if (h4_value == null) {

        if (parseInt(i) == 1) {
          for (var j = 1; j < h1_value; j++) {

            create_node(NODE_LIST, layer = 1, label = "hidden")
          }
        }


        if (parseInt(i) == 2) {
          for (var j = 1; j < h2_value; j++) {

            create_node(NODE_LIST, layer = 2, label = "hidden")
          }
        }

        if (parseInt(i) == 3) {
          for (var j = 1; j < h3_value; j++) {

            create_node(NODE_LIST, layer = 3, label = "hidden")
          }
        }

      }


      else if (h5_value == null) {

        if (parseInt(i) == 1) {
          for (var j = 1; j < h1_value; j++) {

            create_node(NODE_LIST, layer = 1, label = "hidden")
          }
        }


        if (parseInt(i) == 2) {
          for (var j = 1; j < h2_value; j++) {

            create_node(NODE_LIST, layer = 2, label = "hidden")
          }
        }

        if (parseInt(i) == 3) {
          for (var j = 1; j < h3_value; j++) {

            create_node(NODE_LIST, layer = 3, label = "hidden")
          }
        }

        if (parseInt(i) == 4) {
          for (var j = 1; j < h4_value; j++) {

            create_node(NODE_LIST, layer = 4, label = "hidden")
          }
        }

      }

      else {

        if (parseInt(i) == 1) {
          for (var j = 1; j < h1_value; j++) {

            create_node(NODE_LIST, layer = 1, label = "hidden")
          }
        }


        if (parseInt(i) == 2) {
          for (var j = 1; j < h2_value; j++) {

            create_node(NODE_LIST, layer = 2, label = "hidden")
          }
        }

        if (parseInt(i) == 3) {
          for (var j = 1; j < h3_value; j++) {

            create_node(NODE_LIST, layer = 3, label = "hidden")
          }
        }

        if (parseInt(i) == 4) {
          for (var j = 1; j < h4_value; j++) {

            create_node(NODE_LIST, layer = 4, label = "hidden")
          }
        }

        if (parseInt(i) == 5) {
          for (var j = 1; j < h5_value; j++) {

            create_node(NODE_LIST, layer = 5, label = "hidden")
          }
        }

      }

    }


    //output layers
    for (var i = 0; i < out_value; i++) {

      var res = parseInt(hidden_amount) + 1
      console.log("out", res)
      create_node(NODE_LIST, layer = res, label = "out")
    }





    return json
  }
  function Train() {
    var hidden_amount = extract_values("layers")
    var h1_value = extract_values("hidden_units1")
    var h2_value = extract_values("hidden_units2")
    var h3_value = extract_values("hidden_units3")
    var h4_value = extract_values("hidden_units4")
    var h5_value = extract_values("hidden_units5")

    var hidden_activation = extract_values('hidden_activation')

    var hiddenLayers = []

    if (hidden_amount == 1) {
      hiddenLayers.push(h1_value)


    }

    else if (hidden_amount == 2) {
      hiddenLayers.push(h1_value, h2_value)


    }

    else if (hidden_amount == 3) {
      hiddenLayers.push(h1_value, h2_value, h3_value)


    }

    else if (hidden_amount == 4) {
      hiddenLayers.push(h1_value, h2_value, h3_value, h4_value)


    }

    else if (hidden_amount == 5) {
      hiddenLayers.push(h1_value, h2_value, h3_value, h4_value, h5_value)


    }



    const config = {
      binaryThresh: 0.5,
      hiddenLayers: hiddenLayers, // array of ints for the sizes of the hidden layers in the network
      activation: document.getElementById("activation").value, // supported activation types: ['sigmoid', 'relu', 'leaky-relu', 'tanh'],
      relu: 0.01,



    }
    console.log(config)
    // create a simple feed forward neural network with backpropagation
    const net = new brain.NeuralNetwork(config)
    // var x = document.getElementById("training_box").children[1]
    // console.log(x.childNodes()
    // if ($(".scroller").find("h5").length > 0){ // remove old model
    //   alert("found txt")
    //     $("h5").remove() 
    //   }


    var h1 = document.createElement("h5")                // Create a <h1> element


    net.train([
      { input: [0, 0], output: [0] },
      { input: [0, 1], output: [1] },
      { input: [1, 0], output: [1] },
      { input: [1, 1], output: [0] },
    ], {
      log: (stats) => h1.appendChild(document.createTextNode(JSON.stringify(stats))),
      iterations: parseInt(document.getElementById("iterations").value),
      learningRate: parseFloat(document.getElementById("learning_rate").value)
    }


    )
    h1.style.cssText = 'position:relative; top:5vh'
    document.getElementById("scroller").appendChild(h1);

    const output = net.run([1, 0]) // [0.987]
    console.log(output)





  }

  function Render() {
    var hidden_amount = extract_values("layers")
    var in_value = extract_values("in")
    var h1_value =extract_values("hidden_units1")
    var h2_value = extract_values("hidden_units2")
    var h3_value = extract_values("hidden_units3")
    var h4_value = extract_values("hidden_units4")
    var h5_value = extract_values("hidden_units5")
    var out_value = extract_values("out")

    if ($(".body_model").find("svg").length > 0) { // remove old model
      $("svg").remove()
    }

    // creates json formatted model
    var json = create_model(in_value,
      h1_value,
      h2_value,
      h3_value,
      h4_value,
      h5_value,
      out_value,
      hidden_amount)
    new Create_Architecture(x_pos = -.5, y_pos = .2, json).build() //creates arch. based on json format


  }
</script>

<script>
  class Create_Architecture {
    constructor(x_pos, y_pos, json, width = 770, height = 300, nodeSize = 15) {
      // alert('testing')
      this.x_pos = x_pos
      this.y_pos = y_pos
      this.nodes = json[0].nodes;
      this.width = width
      this.height = height
      this.nodeSize = nodeSize
      this.color = d3.scale.category20()
      this.svg = d3.select(".body_model").append("svg")
        .attr("width", window.innerWidth)
        .attr("height", window.innerHeight);


    }
    _get_network_size() {
      // get network size
      var netsize = {};
      this.nodes.forEach(function (d) {
        if (d.layer in netsize) {
          netsize[d.layer] += 1;
        } else {
          netsize[d.layer] = 1;
        }
        d["lidx"] = netsize[d.layer];
      });

      // calc distances between nodes
      var largestLayerSize = Math.max.apply(
        null, Object.keys(netsize).map(function (i) { return netsize[i]; }));

      var xdist = this.width / Object.keys(netsize).length,
        ydist = this.height / largestLayerSize,
        x_pos = this.x_pos,
        y_pos = this.y_pos;
      // create node locations
      this.nodes.map(function (d) {

        d["x"] = (d.layer - x_pos) * xdist;
        d["y"] = (d.lidx - y_pos) * ydist;
      });


    }

    _autogenerate_links() {
      // autogenerate links
      var netsize = {}
      var links = [];
      var nodes = this.nodes;

      this.nodes.map(function (d, i) {
        for (var n in nodes) {
          if (d.layer + 1 == nodes[n].layer) {
            links.push({ "source": parseInt(i), "target": parseInt(n), "value": 1 })
          }

        }

      }).filter(function (d) { return typeof d !== "undefined"; });


      this._draw_links(links)
    }

    _draw_links(links) {
      // draw links
      var nodes = this.nodes
      var link = this.svg.selectAll(".link")
        .data(links)
        .enter().append("line")
        .attr("class", "link")
        .attr("x1", function (d) { return nodes[d.source].x; })
        .attr("y1", function (d) { return nodes[d.source].y; })
        .attr("x2", function (d) { return nodes[d.target].x; })
        .attr("y2", function (d) { return nodes[d.target].y; })
        .style("stroke-width", function (d) { return Math.sqrt(d.value); });



    }


    clear_contents() {
      this.svg.selectAll("*").remove()

    }
    _draw_nodes() {
      var color = this.color
      // draw nodes
      var node = this.svg.selectAll(".node")
        .data(this.nodes)
        .enter().append("g")
        .attr("transform", function (d) {
          return "translate(" + d.x + "," + d.y + ")";
        }
        );

      var circle = node.append("circle")
        .attr("class", "node")
        .attr("r", this.nodeSize)
        .style("fill", function (d) { return color(d.layer); });


      node.append("text")
        .attr("dx", "-.35em")
        .attr("dy", ".35em")
        .text(function (d) { return d.label; });
    }
    build() {

      this._get_network_size()
      this._autogenerate_links()
      this._draw_nodes()



    }
  }
</script>


</html>